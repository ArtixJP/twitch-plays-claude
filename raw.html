<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://unpkg.com https://esm.sh https://esm.run https://cdn.tailwindcss.com https://threejs.org https://cdn.threejs.org https://cdn.p5js.org https://code.jquery.com https://d3js.org https://cdn.plot.ly https://cdn.tonejs.org; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; media-src 'self' https:; font-src 'self' https://fonts.gstatic.com https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; worker-src 'self'; frame-src https://www.youtube.com https://www.youtube-nocookie.com https://player.vimeo.com; connect-src 'self' https: wss: ws:; object-src 'none'; base-uri 'self'; form-action 'self';">
<title>Minecraft World</title>
<style>
*{margin:0;padding:0}body{overflow:hidden}#ui{position:absolute;top:10px;left:10px;color:#fff;font-family:monospace;text-shadow:2px 2px #000}
#hint{position:absolute;bottom:10px;width:100%;text-align:center;color:#8f8;font-family:monospace}
#crosshair{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:24px;text-shadow:1px 1px #000}
#inventory{position:absolute;bottom:50px;left:50%;transform:translateX(-50%);display:flex;gap:5px}
.slot{width:50px;height:50px;border:3px solid #555;background:#0008;display:flex;align-items:center;justify-content:center;font-size:24px;cursor:pointer}
.slot.selected{border-color:#fff}
#speech-bubble{position:absolute;top:20%;left:50%;transform:translateX(-50%);background:#fff;border:4px solid #333;border-radius:20px;padding:15px 25px;font-family:'Comic Sans MS',cursive;font-size:18px;max-width:400px;text-align:center;display:none;box-shadow:0 4px 15px rgba(0,0,0,0.3);animation:bounce 0.5s ease}
#speech-bubble::after{content:'';position:absolute;bottom:-20px;left:50%;transform:translateX(-50%);border:10px solid transparent;border-top-color:#333}
#speech-bubble .speaker{font-weight:bold;color:#FF0000;margin-bottom:5px}
@keyframes bounce{0%{transform:translateX(-50%) scale(0.8)}50%{transform:translateX(-50%) scale(1.05)}100%{transform:translateX(-50%) scale(1)}}
#npc-hint{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#FFD700;font-family:monospace;font-size:14px;text-shadow:2px 2px #000;display:none;pointer-events:none}
</style>
</head>
<body>
<div id="ui">‚õèÔ∏è Minecraft √ó Mario World üçÑ<br/><small>WASD move | SPACE jump | Click place/break | 1-7 select block</small></div>
<div id="crosshair">+</div>
<div id="inventory">
<div class="slot selected" data-block="grass">üü©</div>
<div class="slot" data-block="dirt">üü´</div>
<div class="slot" data-block="stone">‚¨ú</div>
<div class="slot" data-block="wood">ü™µ</div>
<div class="slot" data-block="leaves">üåø</div>
<div class="slot" data-block="sand">üü®</div>
<div class="slot" data-block="water">üü¶</div>
</div>
<div id="hint">üçÑ Left click = place block | Right click = break block | Walk near Toad to talk! üè∞üë∏üê¢üçåüçÑ</div>
<div id="speech-bubble"><div class="speaker">üçÑ TOAD</div><div id="speech-text">Hello there!</div></div>
<div id="npc-hint">Press E to talk</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
const scene=new THREE.Scene();scene.background=new THREE.Color(0x87ceeb);
const camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
const renderer=new THREE.WebGLRenderer();renderer.setSize(innerWidth,innerHeight);document.body.appendChild(renderer.domElement);
const grass=0x4a7c23,dirt=0x8b4513,stone=0x888888,wood=0x8B5A2B,leaves=0x228B22,sand=0xC2B280,water=0x1E90FF;
function block(x,y,z,c){const g=new THREE.BoxGeometry(1,1,1);const m=new THREE.MeshLambertMaterial({color:c});const b=new THREE.Mesh(g,m);b.position.set(x,y,z);scene.add(b);}
const blocks=[];function addBlock(x,y,z,c){const g=new THREE.BoxGeometry(1,1,1);const m=new THREE.MeshLambertMaterial({color:c});const b=new THREE.Mesh(g,m);b.position.set(x,y,z);b.userData.isBlock=true;scene.add(b);blocks.push(b);return b;}
// Terrain generation with noise-like hills
function noise(x,z){return Math.sin(x*0.3)*Math.cos(z*0.3)+Math.sin(x*0.1+z*0.15)*2;}
for(let x=-25;x<25;x++)for(let z=-25;z<25;z++){
  const h=Math.floor(noise(x,z));
  const dist=Math.sqrt(x*x+z*z);
  // Lake in corner
  if(x>10&&x<20&&z>10&&z<20){for(let y=-2;y<=0;y++)addBlock(x,y,z,water);continue;}
  // Beach around lake
  if(x>=8&&x<=22&&z>=8&&z<=22&&!(x>10&&x<20&&z>10&&z<20)){addBlock(x,0,z,sand);addBlock(x,-1,z,sand);continue;}
  // Mountains far away
  if(dist>18){const mh=Math.floor((dist-18)*0.3)+h;for(let y=-1;y<=mh;y++)addBlock(x,y,z,y===mh?stone:stone);continue;}
  // Normal terrain with grass and dirt layers
  for(let y=-2;y<=h;y++){addBlock(x,y,z,y===h?grass:dirt);}
  // Random flowers (colored stones) 
  if(Math.random()>0.97&&h>=0)addBlock(x,h+1,z,0xff69b4);
}
// TOWER
for(let y=1;y<=8;y++){addBlock(5,y,5,stone);addBlock(5,y,7,stone);addBlock(7,y,5,stone);addBlock(7,y,7,stone);}
for(let x=5;x<=7;x++)for(let z=5;z<=7;z++)addBlock(x,9,z,stone);
addBlock(6,10,6,grass);
// FOREST with trees
const treePositions=[[-5,-5],[-8,-3],[-3,-8],[-10,-10],[-15,-5],[-5,-15],[3,-10],[-12,-8],[-20,-15],[-18,-3],[-6,-20]];
treePositions.forEach(([tx,tz])=>{
  const th=Math.floor(noise(tx,tz));
  for(let y=th+1;y<=th+5;y++)addBlock(tx,y,tz,wood);
  for(let lx=-2;lx<=2;lx++)for(let lz=-2;lz<=2;lz++)for(let ly=0;ly<=2;ly++){
    if(Math.abs(lx)+Math.abs(lz)+ly<4&&!(lx===0&&lz===0&&ly===0))addBlock(tx+lx,th+4+ly,tz+lz,leaves);
  }
});
// MARIO PIPE - Green warp pipe
for(let y=0;y<=3;y++){for(let a=0;a<8;a++){const px=-10+Math.cos(a*Math.PI/4)*1.5;const pz=10+Math.sin(a*Math.PI/4)*1.5;addBlock(Math.round(px),y,Math.round(pz),0x228B22);}}
for(let a=0;a<12;a++){const px=-10+Math.cos(a*Math.PI/6)*2;const pz=10+Math.sin(a*Math.PI/6)*2;addBlock(Math.round(px),4,Math.round(pz),0x228B22);}

// BOWSER STATUE (pixel art style blocks) - Enhanced!
const bowserX=-15,bowserZ=-12;
for(let y=1;y<=6;y++)addBlock(bowserX,y,bowserZ,0x228B22); // body
for(let y=1;y<=6;y++)addBlock(bowserX+1,y,bowserZ,0x228B22);
addBlock(bowserX,7,bowserZ,0xFFA500); // head
addBlock(bowserX+1,7,bowserZ,0xFFA500);
addBlock(bowserX,8,bowserZ,0xFF4500); // horns
addBlock(bowserX+1,8,bowserZ,0xFF4500);
addBlock(bowserX-1,4,bowserZ,0x228B22); // arms
addBlock(bowserX+2,4,bowserZ,0x228B22);
addBlock(bowserX,0,bowserZ-1,0xFFA500); // feet
addBlock(bowserX+1,0,bowserZ-1,0xFFA500);
// Bowser's menacing eyes
const bowserEyeGeo=new THREE.BoxGeometry(0.35,0.35,0.35);
const bowserEyeMat=new THREE.MeshLambertMaterial({color:0xFF0000});
const bowserEye1=new THREE.Mesh(bowserEyeGeo,bowserEyeMat);bowserEye1.position.set(bowserX-0.1,7.3,bowserZ-0.6);scene.add(bowserEye1);
const bowserEye2=new THREE.Mesh(bowserEyeGeo,bowserEyeMat);bowserEye2.position.set(bowserX+1.1,7.3,bowserZ-0.6);scene.add(bowserEye2);
// Bowser's shell spikes
addBlock(bowserX,4,bowserZ+1,0x8B0000);
addBlock(bowserX+1,5,bowserZ+1,0x8B0000);
addBlock(bowserX,6,bowserZ+1,0x8B0000);

// PEACH STATUE - Enhanced with facial features!
const peachX=-18,peachZ=-12;
for(let y=1;y<=4;y++)addBlock(peachX,y,peachZ,0xFFB6C1); // pink dress
addBlock(peachX,5,peachZ,0xFFE4B5); // face
addBlock(peachX,6,peachZ,0xFFD700); // crown
addBlock(peachX-1,6,peachZ,0xFFD700);
addBlock(peachX+1,6,peachZ,0xFFD700);
addBlock(peachX-1,3,peachZ,0xFFB6C1); // arms
addBlock(peachX+1,3,peachZ,0xFFB6C1);
// Peach's eyes and smile
const peachEyeGeo=new THREE.BoxGeometry(0.25,0.25,0.25);
const peachEyeMat=new THREE.MeshLambertMaterial({color:0x4169E1});
const peachEye1=new THREE.Mesh(peachEyeGeo,peachEyeMat);peachEye1.position.set(peachX-0.25,5.2,peachZ-0.55);scene.add(peachEye1);
const peachEye2=new THREE.Mesh(peachEyeGeo,peachEyeMat);peachEye2.position.set(peachX+0.25,5.2,peachZ-0.55);scene.add(peachEye2);
const peachSmileGeo=new THREE.BoxGeometry(0.4,0.12,0.1);
const peachSmileMat=new THREE.MeshLambertMaterial({color:0xFF69B4});
const peachSmile=new THREE.Mesh(peachSmileGeo,peachSmileMat);peachSmile.position.set(peachX,4.85,peachZ-0.55);scene.add(peachSmile);
// Hair
addBlock(peachX,7,peachZ,0xFFD700);
addBlock(peachX-1,5,peachZ,0xFFD700);
addBlock(peachX+1,5,peachZ,0xFFD700);

// TOAD STATUE next to Peach - Enhanced with more detail!
const toadX=-21,toadZ=-12;
for(let y=1;y<=2;y++)addBlock(toadX,y,toadZ,0xFFFFFF); // white body
addBlock(toadX,3,toadZ,0xFFE4B5); // face
addBlock(toadX,4,toadZ,0xFF0000); // red mushroom cap
addBlock(toadX-1,4,toadZ,0xFF0000);
addBlock(toadX+1,4,toadZ,0xFF0000);
addBlock(toadX,5,toadZ,0xFF0000);
addBlock(toadX,4,toadZ-1,0xFFFFFF); // white spots
addBlock(toadX,4,toadZ+1,0xFFFFFF);
addBlock(toadX-1,3,toadZ,0xFFFFFF); // arms
addBlock(toadX+1,3,toadZ,0xFFFFFF);
// Toad's eyes (small dark blocks)
const toadEyeGeo=new THREE.BoxGeometry(0.3,0.3,0.3);
const toadEyeMat=new THREE.MeshLambertMaterial({color:0x000000});
const toadEye1=new THREE.Mesh(toadEyeGeo,toadEyeMat);toadEye1.position.set(toadX-0.3,3.2,toadZ-0.6);scene.add(toadEye1);
const toadEye2=new THREE.Mesh(toadEyeGeo,toadEyeMat);toadEye2.position.set(toadX+0.3,3.2,toadZ-0.6);scene.add(toadEye2);
// Toad's smile
const smileGeo=new THREE.BoxGeometry(0.5,0.15,0.1);
const smileMat=new THREE.MeshLambertMaterial({color:0x8B0000});
const toadSmile=new THREE.Mesh(smileGeo,smileMat);toadSmile.position.set(toadX,2.8,toadZ-0.55);scene.add(toadSmile);

// TOAD DIALOGUE SYSTEM
const toadDialogues=[
  "Welcome to the Mushroom Kingdom! üçÑ",
  "Princess Peach is right over there! She's so kind!",
  "Watch out for Bowser... he's always causing trouble!",
  "Did you find all the bananas? They're hidden everywhere!",
  "The floating castle up there? That's Peach's vacation home!",
  "I love this Minecraft world! So many blocks!",
  "Try building something cool! Use 1-7 to select blocks!",
  "The green pipe leads to... well, I'm not sure actually!",
  "Have you seen the lake? Perfect for a swim! üèä",
  "Mario couldn't make it today. He's-a busy!"
];
let currentDialogue=0;
let toadTalkCooldown=0;
const speechBubble=document.getElementById('speech-bubble');
const speechText=document.getElementById('speech-text');
const npcHint=document.getElementById('npc-hint');

function showToadDialogue(){
  speechText.textContent=toadDialogues[currentDialogue];
  speechBubble.style.display='block';
  currentDialogue=(currentDialogue+1)%toadDialogues.length;
  toadTalkCooldown=180; // 3 seconds at 60fps
  setTimeout(()=>{speechBubble.style.display='none';},4000);
}

document.addEventListener('keydown',e=>{
  if(e.key.toLowerCase()==='e'&&toadTalkCooldown<=0){
    const dist=Math.sqrt(Math.pow(camera.position.x-toadX,2)+Math.pow(camera.position.z-toadZ,2));
    if(dist<6)showToadDialogue();
  }
});

// BANANAS scattered around (Mario Kart style collectibles)
const bananaPositions=[[3,2,-5],[8,1,3],[-7,2,8],[0,3,12],[-12,2,-3],[12,1,-8],[-3,2,15],[6,2,-12],[-20,2,5],[18,1,0]];
bananaPositions.forEach(([bx,by,bz])=>{
  const th=Math.floor(noise(bx,bz));
  addBlock(bx,th+by,bz,0xFFE135); // banana yellow
});

// Tiny gravestone for chaos (acknowledging 'remove everything' request)
addBlock(-24,1,-24,0x444444); // gravestone
addBlock(-24,2,-24,0x555555);

// FLOATING MUSHROOM CASTLE
const castleX=15,castleY=15,castleZ=-15;
for(let x=-3;x<=3;x++)for(let z=-3;z<=3;z++)addBlock(castleX+x,castleY,castleZ+z,0xFFFFFF);
for(let y=1;y<=4;y++){addBlock(castleX-3,castleY+y,castleZ-3,0xFFFFFF);addBlock(castleX+3,castleY+y,castleZ-3,0xFFFFFF);addBlock(castleX-3,castleY+y,castleZ+3,0xFFFFFF);addBlock(castleX+3,castleY+y,castleZ+3,0xFFFFFF);}
for(let x=-3;x<=3;x++)for(let z=-3;z<=3;z++)addBlock(castleX+x,castleY+5,castleZ+z,0xFF0000);
addBlock(castleX,castleY+6,castleZ,0xFF0000);
addBlock(castleX,castleY+7,castleZ,0xFFFFFF); // flag pole
addBlock(castleX,castleY+8,castleZ,0xFFFFFF);
addBlock(castleX+1,castleY+8,castleZ,0xFF0000); // flag
addBlock(castleX+1,castleY+7,castleZ,0xFF0000);

// QUESTION BLOCKS floating
addBlock(-5,8,0,0xFFD700);addBlock(-3,8,0,0xFFD700);addBlock(-1,8,0,0xFFD700);
addBlock(0,10,5,0x8B4513); // brick block

// More scattered trees
for(let i=0;i<15;i++){
  const tx=Math.floor(Math.random()*30-15);
  const tz=Math.floor(Math.random()*30-15);
  if(tx>8&&tx<22&&tz>8&&tz<22)continue;
  const th=Math.floor(noise(tx,tz));
  for(let y=th+1;y<=th+4;y++)addBlock(tx,y,tz,wood);
  for(let lx=-1;lx<=1;lx++)for(let lz=-1;lz<=1;lz++)for(let ly=0;ly<=1;ly++){
    if(!(lx===0&&lz===0&&ly===0))addBlock(tx+lx,th+3+ly,tz+lz,leaves);
  }
}
const light=new THREE.DirectionalLight(0xffeedd,1.2);light.position.set(50,80,30);scene.add(light);scene.add(new THREE.AmbientLight(0x6688aa,0.6));
// Add fog for atmosphere
scene.fog=new THREE.Fog(0x87ceeb,20,80);
// Add sun visual
const sunGeo=new THREE.SphereGeometry(3,16,16);const sunMat=new THREE.MeshBasicMaterial({color:0xffff88});const sun=new THREE.Mesh(sunGeo,sunMat);sun.position.set(50,60,30);scene.add(sun);
// Clouds
for(let i=0;i<10;i++){const cloudGeo=new THREE.SphereGeometry(Math.random()*3+2,8,8);const cloudMat=new THREE.MeshBasicMaterial({color:0xffffff,transparent:true,opacity:0.8});const cloud=new THREE.Mesh(cloudGeo,cloudMat);cloud.position.set(Math.random()*80-40,25+Math.random()*10,Math.random()*80-40);scene.add(cloud);}
camera.position.set(0,3,10);let yVel=0,onGround=true;
const raycaster=new THREE.Raycaster();const mouse=new THREE.Vector2();
let selectedBlock='grass';const blockColors={grass:0x4a7c23,dirt:0x8b4513,stone:0x888888,wood:0x8B5A2B,leaves:0x228B22,sand:0xC2B280,water:0x1E90FF};
document.querySelectorAll('.slot').forEach(s=>s.onclick=()=>{document.querySelector('.slot.selected').classList.remove('selected');s.classList.add('selected');selectedBlock=s.dataset.block;});
document.onkeypress=e=>{if(e.key>='1'&&e.key<='7'){const slots=document.querySelectorAll('.slot');document.querySelector('.slot.selected').classList.remove('selected');slots[e.key-1].classList.add('selected');selectedBlock=slots[e.key-1].dataset.block;}};
const keys={};document.onkeydown=e=>keys[e.key.toLowerCase()]=1;document.onkeyup=e=>keys[e.key.toLowerCase()]=0;
let angle=0;
function animate(){requestAnimationFrame(animate);
if(keys.a)angle+=0.03;if(keys.d)angle-=0.03;
if(keys.w){camera.position.x-=Math.sin(angle)*0.1;camera.position.z-=Math.cos(angle)*0.1;}
if(keys.s){camera.position.x+=Math.sin(angle)*0.1;camera.position.z+=Math.cos(angle)*0.1;}
if(keys[' ']&&onGround){yVel=0.15;onGround=false;}
yVel-=0.008;camera.position.y+=yVel;
if(camera.position.y<3){camera.position.y=3;yVel=0;onGround=true;}
camera.rotation.y=angle;
// Check proximity to Toad for hint
const distToToad=Math.sqrt(Math.pow(camera.position.x-toadX,2)+Math.pow(camera.position.z-toadZ,2));
if(distToToad<6&&toadTalkCooldown<=0){npcHint.style.display='block';}else{npcHint.style.display='none';}
if(toadTalkCooldown>0)toadTalkCooldown--;
renderer.render(scene,camera);}
renderer.domElement.onclick=e=>{mouse.x=(e.clientX/innerWidth)*2-1;mouse.y=-(e.clientY/innerHeight)*2+1;
raycaster.setFromCamera(mouse,camera);const hits=raycaster.intersectObjects(blocks);
if(hits.length>0){const hit=hits[0];if(e.shiftKey||e.button===2){scene.remove(hit.object);blocks.splice(blocks.indexOf(hit.object),1);}
else{const n=hit.face.normal;const p=hit.object.position;addBlock(p.x+n.x,p.y+n.y,p.z+n.z,blockColors[selectedBlock]);}}};
renderer.domElement.oncontextmenu=e=>{e.preventDefault();mouse.x=(e.clientX/innerWidth)*2-1;mouse.y=-(e.clientY/innerHeight)*2+1;
raycaster.setFromCamera(mouse,camera);const hits=raycaster.intersectObjects(blocks);
if(hits.length>0){scene.remove(hits[0].object);blocks.splice(blocks.indexOf(hits[0].object),1);}};
animate();onresize=()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight);};
</script>
</body>
</html>