<!DOCTYPE html>

<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://unpkg.com https://esm.sh https://esm.run https://cdn.tailwindcss.com https://threejs.org https://cdn.threejs.org https://cdn.p5js.org https://code.jquery.com https://d3js.org https://cdn.plot.ly https://cdn.tonejs.org; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; media-src 'self' https:; font-src 'self' https://fonts.gstatic.com https://fonts.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; worker-src 'self'; frame-src https://www.youtube.com https://www.youtube-nocookie.com https://player.vimeo.com; connect-src 'self' https: wss: ws:; object-src 'none'; base-uri 'self'; form-action 'self';">
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Twitch plays Claude - Penalty Arena</title>
<style>
        body { 
            font-family: system-ui, sans-serif; 
            display: flex; 
            flex-direction: column;
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            overflow: hidden;
        }
        h1 { 
            font-size: 2.5rem; 
            text-align: center; 
            margin-bottom: 0.5rem;
            text-shadow: 0 0 20px rgba(145, 71, 255, 0.6);
            position: relative;
            z-index: 10;
        }
        .instruction {
            text-align: center;
            font-size: 1rem;
            color: #a0aec0;
            max-width: 600px;
            margin: 0 auto;
            padding: 0 15px;
            line-height: 1.5;
        }
        .instruction code {
            background: rgba(145, 71, 255, 0.2);
            padding: 2px 8px;
            border-radius: 4px;
            color: #bf94ff;
        }
        #penalty-arena {
            border: 3px solid #00ff88;
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.4), inset 0 0 20px rgba(0, 255, 136, 0.1);
            margin: 15px 0;
            position: relative;
            z-index: 5;
        }
        .ai-status {
            font-size: 0.9rem;
            color: #00ff88;
            background: rgba(0, 255, 136, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(0, 255, 136, 0.3);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            z-index: 10;
        }
        .pulse {
            animation: pulse 1s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        .score-display {
            font-size: 1.3rem;
            position: relative;
            z-index: 10;
            color: #ffdd57;
            text-shadow: 0 0 10px #ffdd57;
            margin-bottom: 10px;
            font-family: 'Courier New', monospace;
            display: flex;
            gap: 20px;
        }
        .goals { color: #00ff88; text-shadow: 0 0 10px #00ff88; }
        .saves { color: #ff4757; text-shadow: 0 0 10px #ff4757; }
        .football-bg {
            position: fixed;
            font-size: 2rem;
            animation: floatBg 8s ease-in-out infinite;
            z-index: 1;
            pointer-events: none;
            opacity: 0.3;
        }
        @keyframes floatBg {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        .result-flash {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .result-flash.show { opacity: 1; }
        .result-flash.goal { color: #00ff88; text-shadow: 0 0 30px #00ff88; }
        .result-flash.save { color: #ff4757; text-shadow: 0 0 30px #ff4757; }
    </style>
</head>
<body>
<div id="bg-container"></div>
<h1>‚öΩ AI Penalty Shootout</h1>
<div class="ai-status">ü§ñ AI STRIKER vs AI KEEPER <span class="pulse">‚óè</span></div>
<div class="score-display">
<span class="goals">Goals: <span id="goals">0</span></span>
<span class="saves">Saves: <span id="saves">0</span></span>
<span>Shots: <span id="shots">0</span></span>
</div>
<canvas height="280" id="penalty-arena" width="400"></canvas>
<div class="result-flash" id="result"></div>
<p class="instruction">
        Type <code>!idea &lt;your idea&gt;</code> in the Twitch chat to add to this page.<br/>
        Example: <code>!idea Add crowd cheering sounds</code>
</p>
<script>
        const canvas = document.getElementById('penalty-arena');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let goals = 0;
        let saves = 0;
        let shots = 0;
        let gamePhase = 'aiming'; // aiming, shooting, result
        let ball = { x: 200, y: 230, vx: 0, vy: 0, radius: 12 };
        let keeper = { x: 200, y: 50, width: 60, height: 20, targetX: 200 };
        let aimAngle = 0;
        let aimSpeed = 0.03;
        let shootPower = 0;
        let powerDir = 1;
        let resultTimer = 0;
        let particles = [];
        
        // Goal dimensions
        const goal = { x: 100, y: 20, width: 200, height: 60 };
        
        function createParticles(x, y, color) {
            for (let i = 0; i < 15; i++) {
                particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 12,
                    vy: (Math.random() - 0.5) * 12,
                    life: 30,
                    color: color
                });
            }
        }
        
        function showResult(text, isGoal) {
            const el = document.getElementById('result');
            el.textContent = text;
            el.className = 'result-flash show ' + (isGoal ? 'goal' : 'save');
            setTimeout(() => el.className = 'result-flash', 1500);
        }
        
        function resetBall() {
            ball = { x: 200, y: 230, vx: 0, vy: 0, radius: 12 };
            gamePhase = 'aiming';
            shootPower = 0;
            keeper.targetX = 100 + Math.random() * 200;
        }
        
        function aiAim() {
            aimAngle += aimSpeed;
            if (Math.random() < 0.02) aimSpeed = (Math.random() - 0.5) * 0.06;
            
            // AI decides to shoot randomly
            if (Math.random() < 0.008) {
                gamePhase = 'power';
            }
        }
        
        function aiPower() {
            shootPower += powerDir * 2;
            if (shootPower >= 100 || shootPower <= 0) powerDir *= -1;
            
            // AI decides power randomly
            if (Math.random() < 0.03 && shootPower > 30) {
                shoot();
            }
        }
        
        function shoot() {
            const targetX = 200 + Math.sin(aimAngle) * 90;
            const power = shootPower / 100 * 15 + 5;
            ball.vx = (targetX - ball.x) * 0.08;
            ball.vy = -power;
            gamePhase = 'shooting';
            shots++;
            document.getElementById('shots').textContent = shots;
            
            // Keeper AI reacts
            keeper.targetX = 100 + Math.random() * 200; // Guess!
        }
        
        function update() {
            if (gamePhase === 'aiming') {
                aiAim();
            } else if (gamePhase === 'power') {
                aiPower();
            } else if (gamePhase === 'shooting') {
                ball.x += ball.vx;
                ball.y += ball.vy;
                ball.vy += 0.2; // Slight curve
                
                // Keeper moves
                keeper.x += (keeper.targetX - keeper.x) * 0.15;
                
                // Check if ball reached goal line
                if (ball.y <= goal.y + goal.height) {
                    const inGoalX = ball.x > goal.x && ball.x < goal.x + goal.width;
                    const inGoalY = ball.y > goal.y && ball.y < goal.y + goal.height;
                    const hitKeeper = Math.abs(ball.x - keeper.x) < keeper.width/2 + ball.radius &&
                                     Math.abs(ball.y - keeper.y) < keeper.height/2 + ball.radius;
                    
                    if (inGoalX && !hitKeeper) {
                        goals++;
                        document.getElementById('goals').textContent = goals;
                        createParticles(ball.x, ball.y, '#00ff88');
                        showResult('‚öΩ GOAL!', true);
                    } else {
                        saves++;
                        document.getElementById('saves').textContent = saves;
                        createParticles(ball.x, ball.y, '#ff4757');
                        showResult('üß§ SAVED!', false);
                    }
                    gamePhase = 'result';
                    resultTimer = 60;
                }
                
                // Ball out of bounds
                if (ball.y < 0 || ball.x < 0 || ball.x > 400) {
                    saves++;
                    document.getElementById('saves').textContent = saves;
                    showResult('‚ùå MISS!', false);
                    gamePhase = 'result';
                    resultTimer = 60;
                }
            } else if (gamePhase === 'result') {
                resultTimer--;
                if (resultTimer <= 0) resetBall();
            }
            
            // Update particles
            particles = particles.filter(p => {
                p.x += p.vx;
                p.y += p.vy;
                p.life--;
                return p.life > 0;
            });
        }
        
        function draw() {
            // Pitch background
            ctx.fillStyle = '#1a472a';
            ctx.fillRect(0, 0, 400, 280);
            
            // Pitch lines
            ctx.strokeStyle = 'rgba(255,255,255,0.5)';
            ctx.lineWidth = 2;
            ctx.strokeRect(50, 10, 300, 260);
            
            // Goal area
            ctx.strokeRect(120, 10, 160, 80);
            
            // Penalty spot
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(200, 230, 4, 0, Math.PI * 2);
            ctx.fill();
            
            // Goal posts with glow
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#ffffff';
            ctx.strokeStyle = '#ffffff';
            ctx.lineWidth = 6;
            ctx.beginPath();
            ctx.moveTo(goal.x, goal.y + goal.height);
            ctx.lineTo(goal.x, goal.y);
            ctx.lineTo(goal.x + goal.width, goal.y);
            ctx.lineTo(goal.x + goal.width, goal.y + goal.height);
            ctx.stroke();
            
            // Goal net
            ctx.shadowBlur = 0;
            ctx.strokeStyle = 'rgba(255,255,255,0.2)';
            ctx.lineWidth = 1;
            for (let i = 0; i < 10; i++) {
                ctx.beginPath();
                ctx.moveTo(goal.x + i * 22, goal.y);
                ctx.lineTo(goal.x + i * 22, goal.y + goal.height);
                ctx.stroke();
            }
            
            // Keeper
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#ff4757';
            ctx.fillStyle = '#ff4757';
            ctx.fillRect(keeper.x - keeper.width/2, keeper.y - keeper.height/2, keeper.width, keeper.height);
            
            // Keeper gloves
            ctx.fillStyle = '#ffdd57';
            ctx.fillRect(keeper.x - keeper.width/2 - 8, keeper.y - 5, 10, 15);
            ctx.fillRect(keeper.x + keeper.width/2 - 2, keeper.y - 5, 10, 15);
            
            // Aim indicator
            if (gamePhase === 'aiming' || gamePhase === 'power') {
                const targetX = 200 + Math.sin(aimAngle) * 90;
                ctx.strokeStyle = 'rgba(255, 221, 87, 0.6)';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(ball.x, ball.y);
                ctx.lineTo(targetX, goal.y + goal.height);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // Target reticle
                ctx.strokeStyle = '#ffdd57';
                ctx.beginPath();
                ctx.arc(targetX, goal.y + goal.height, 10, 0, Math.PI * 2);
                ctx.stroke();
            }
            
            // Power bar
            if (gamePhase === 'power') {
                ctx.fillStyle = 'rgba(0,0,0,0.5)';
                ctx.fillRect(350, 50, 20, 150);
                const powerColor = shootPower < 50 ? '#00ff88' : shootPower < 80 ? '#ffdd57' : '#ff4757';
                ctx.fillStyle = powerColor;
                ctx.fillRect(350, 200 - shootPower * 1.5, 20, shootPower * 1.5);
                ctx.strokeStyle = 'white';
                ctx.strokeRect(350, 50, 20, 150);
            }
            
            // Ball with glow
            ctx.shadowBlur = 20;
            ctx.shadowColor = '#ffffff';
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // Ball pattern
            ctx.shadowBlur = 0;
            ctx.fillStyle = '#333';
            ctx.beginPath();
            ctx.arc(ball.x - 3, ball.y - 3, 4, 0, Math.PI * 2);
            ctx.fill();
            ctx.beginPath();
            ctx.arc(ball.x + 5, ball.y + 2, 3, 0, Math.PI * 2);
            ctx.fill();
            
            // Particles
            particles.forEach(p => {
                ctx.globalAlpha = p.life / 30;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 4, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
        }
        
        function gameLoop() {
            update();
            draw();
        }
        
        setInterval(gameLoop, 1000/30);
        
        // Background footballs
        function createBgFootball() {
            const container = document.getElementById('bg-container');
            const ball = document.createElement('div');
            ball.className = 'football-bg';
            ball.textContent = '‚öΩ';
            ball.style.left = Math.random() * 100 + 'vw';
            ball.style.top = Math.random() * 100 + 'vh';
            ball.style.animationDelay = Math.random() * 5 + 's';
            container.appendChild(ball);
        }
        
        for(let i = 0; i < 8; i++) createBgFootball();
    </script>
</body>
</html>